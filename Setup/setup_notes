#!/bin/bash

################################################################################
#
#   _  _         _                                            _
#  | \| |  ___  | |_   ___   ___    ___   _ _      ___  ___  | |_   _  _   _ __
#  | .` | / _ \ |  _| / -_) (_-<   / _ \ | ' \    (_-< / -_) |  _| | || | | '_ \
#  |_|\_| \___/  \__| \___| /__/   \___/ |_||_|   /__/ \___|  \__|  \_,_| | .__/
#                                                                         |_|
#
################################################################################




#   __       ___
#  |__)  /\   |  |__|
#  |    /~~\  |  |  |
#  ------------------



# Smarter path add funcs
# ======================
# These functions will only add something to path IF it
#  is not present in path already
path_append() {
    if [ -d "$1" ] && [[ ":$PATH:" != *":$1:"* ]]; then
        PATH="${PATH:+"$PATH:"}$1"
    fi
}
path_prepend() {
    if [ -d "$1" ] && [[ ":$PATH:" != *":$1:"* ]]; then
        PATH="$1${PATH:+:${PATH}}"
    fi
}


###############################################################################
#                                                                             #
#                 ██████╗ ██████╗ ███████╗███╗   ██╗██╗   ██╗                 #
#                 ██╔══██╗██╔══██╗██╔════╝████╗  ██║██║   ██║                 #
#                 ██████╔╝██████╔╝█████╗  ██╔██╗ ██║██║   ██║                 #
#                 ██╔══██╗██╔══██╗██╔══╝  ██║╚██╗██║╚██╗ ██╔╝                 #
#                 ██║  ██║██████╔╝███████╗██║ ╚████║ ╚████╔╝                  #
#                 ╚═╝  ╚═╝╚═════╝ ╚══════╝╚═╝  ╚═══╝  ╚═══╝                   #
###############################################################################


# INSTALLATION
# ============

# 1 - Use the installer
wget -q https://github.com/rbenv/rbenv-installer/raw/master/bin/rbenv-installer -O- | bash

# 2 - Update shell config for rbenv path and init
#---- Path
PATH="${PATH:+"$PATH:"}$HOME/.rbenv/bin"
# The "official" way:
echo 'export PATH="$HOME/.rbenv/bin:$PATH"' >> ~/.zshrc
#---- init
eval "$(rbenv init -)"


# 4 - Install a ruby version
rbenv install -l   # list all ruby versions available
rbenv install 2.5.3

# 5 - Local your rbenv ver and check gems path
rbenv local 2.5.3
gem env home  # should show rbenv
#  /home/evan/.rbenv/versions/2.5.3/lib/ruby/gems/2.5.0

# 6 - install gems
gem install bundler


###############################################################################
#                                                                             #
#                      ███████╗ ██████╗██████╗ ██╗    ██╗                     #
#                      ██╔════╝██╔════╝██╔══██╗██║    ██║                     #
#                      ███████╗██║     ██████╔╝██║ █╗ ██║                     #
#                      ╚════██║██║     ██╔══██╗██║███╗██║                     #
#                      ███████║╚██████╗██████╔╝╚███╔███╔╝                     #
#                      ╚══════╝ ╚═════╝╚═════╝  ╚══╝╚══╝                      #
###############################################################################


#    __   __   __        ___  __
#   |  \ /  \ /  ` |__/ |__  |__)
#   |__/ \__/ \__, |  \ |___ |  \
#

# Instructions from SCBW
#   github.com/Games-and-Simulations/sc-docker
# =======================
sudo apt update
sudo apt install -y apt-transport-https ca-certificates curl software-properties-common

#=== add docker repository
curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
sudo add-apt-repository "deb [arch=amd64] https://download.docker.com/linux/ubuntu $(lsb_release -cs) stable"

#=== install docker
sudo apt update
sudo apt install -y docker-ce=17.09.0~ce-0~ubuntu # NB: this ver pkg was UNAVAILABLE

#=== Make sure you can run docker without sudo
sudo usermod -aG docker $USER
# Restart shell
docker run hello-world

#    __      ___       __           __   ___ ___       __
#   |__) \ /  |  |__| /  \ |\ |    /__` |__   |  |  | |__)
#   |     |   |  |  | \__/ | \|    .__/ |___  |  \__/ |
#

# Steps here different, assuming you have pyenv
pip install scbw
scbw.play --install  # This can take awhile, download n install


#    __             __   ___ ___       __                 __
#   / _` |  | |    /__` |__   |  |  | |__) .   \  / |\ | /  `
#   \__> \__/ |    .__/ |___  |  \__/ |    .    \/  | \| \__,
#

#=== Download VNC Viewer @   https://www.realvnc.com/en/connect/download/viewer/linux/
# eg: https://www.realvnc.com/download/file/viewer.files/VNC-Viewer-6.18.907-Linux-x64.deb

#######    IF YOU DOWNLOADED THE .deb,  INSTEAD OF BINARY             #########

#  VNC viewer is launched via 'vncviewer' through the deb install
#  However, scbw launches through 'vnc-viewer', so you need to symlink to same dir
#   >>-----> ln -s /usr/bin/vncviewer /usr/bin/vnc-viewer
#   * the scbw instructions say to symlink the binary to /usr/bin as 'vnc-viewer'
#   * the .deb is actually launched by 'vncviewer'


# FINALLY: watch a match between two bots!
#  (in headful mode, you must select the map, wait in lobby for bots to join, and start)
scbw.play --bots "krasi0" "CherryPi" --show_all
